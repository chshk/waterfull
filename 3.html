<!DOCTYPE html>
<html lang="en">

<head>
  <title></title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    .main {
      position: relative;
    }

    .box {
      float: left;
      padding: 15px 0 0 15px;
    }

    .pic {
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 0 10px #333;
    }

    img {
      width: 165px;
      height: auto;
    }
  </style>
</head>

<body>
  <div class="main">
    <div class="box">
      <div class="pic"><img src="./img/1.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/2.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/3.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/4.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/5.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/6.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/7.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/8.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/9.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/10.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/11.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/12.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/13.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/14.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/15.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/16.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/17.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/18.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/19.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/20.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/21.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/22.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/23.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/24.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/25.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/26.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/27.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/28.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/29.jpg" alt=""></div>
    </div>
    <div class="box">
      <div class="pic"><img src="./img/30.jpg" alt=""></div>
    </div>
  </div>
</body>

</html>

<script>
  window.onload = function () {
    waterfall();
  }

  var oMain = document.querySelector(".main");
  var aBox = document.querySelectorAll(".box");
  var boxW = aBox[0].offsetWidth;
  var cols = Math.floor(document.documentElement.clientWidth / boxW);
  oMain.style.cssText = "width:" + boxW * cols + "px;margin:0 auto;";

  var hArr = [];

  function waterfall() {
    var oMain = document.querySelector(".main");
    var aBox = document.querySelectorAll(".box");
    for (var i = 0; i < aBox.length; i++) {
      if (i < cols) {
        hArr.push(aBox[i].offsetHeight);
      } else {
        var minH = Math.min.apply(null, hArr);
        var index = getIndex(hArr, minH);
        aBox[i].style.position = "absolute";
        aBox[i].style.top = minH + "px";
        aBox[i].style.left = boxW * index + "px";
        hArr[index] += aBox[i].offsetHeight;
      }
    }
  }

  function getIndex(arr, val) {
    for (var i in arr) {
      if (arr[i] == val) {
        return i;
      }
    }
  }
</script>